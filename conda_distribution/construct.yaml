{% set version = os.environ.get("VERSION", "2021.07.08") %}
{% set blas_impl = os.environ.get("BLAS_IMPL", "openblas") %}

name: HyperSpy-bundle
version: {{ version }}

condarc:
  channels:
    - conda-forge
    - nodefaults
  pinned_packages:
    - libblas=*=*{{ blas_impl }}
  solver: libmamba

channels:
  - conda-forge
  - nodefaults

mirrored_channels:
  conda-forge:
    - "https://conda.anaconda.org/conda-forge"
    - "https://prefix.dev/conda-forge"

specs:
  - abtem
  - ase
  - atomap >=0.4.2
  - conda >=25.11.1
  - dask-core >=2023.6.0
  - dask-labextension
  - dask-image
  - etspy
  - exspy
  - hdf5plugin
  - holospy
  - hyperspy >=2.4.0
  - hyperspyui >=2.0.2
  - ipympl
  - jupyterlab
  - kikuchipy >=0.11.3
  - libblas=*=*{{ blas_impl }}
  - lumispy >=0.3.0
  # conda 25.11.0 doesn't seem to be compatible with mamba 2.4.0 on linux
  - mamba >=2.5.0
  - mamba_gator
  - matplotlib-scalebar
  - miniforge_console_shortcut              # [win]
  - nb_conda_kernels
  - nglview
  - notebook
  - orix >=0.14.1
  - ovito
  - particlespy
  - pillow
  # incompatible pinning with scikit-learn
  # https://github.com/conda-forge/py4dstem-feedstock
  #- py4dstem >=0.14.18
  #- pymatgen
  - pystackreg
  - python 3.12*
  - python-graphviz
  - python-rapidjson
  - pyxem >=0.21
  - openpyxl
  - qtconsole >=5.4.3
  - rosettasciio >=0.12.0
  - scanning_drift_corr
  - spyder >=6.0
  - start_jupyter_cm
  - xlrd

license_file: LICENSE

post_install: post_install.sh               # [linux]
post_install: post_install_macosx.sh        # [osx]
post_install: post_install.bat              # [win]

pre_uninstall: pre_uninstall.bat            # [win]

post_install_desc: "Add context menu shortcuts." # [win]


transmute_file_type: ".conda"
installer_type: pkg                         # [osx]

# Icon image for Windows installer
icon_image: hyperspy_bundle_installer.ico   # [win]

default_prefix: '%USERPROFILE%\HyperSpy-bundle' # [win]
default_prefix_domain_user: '%USERDOMAIN%\%USERNAME%\HyperSpy-bundle' # [win]

check_path_length: true                      # [win]

welcome_image_text: |-
                    HyperSpy
                    bundle
header_image_text:  |-
                    HyperSpy
                    bundle

company: The HyperSpy developers
